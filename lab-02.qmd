---
title: "Lab 2 - Data wrangling"
author: "Jessica St. Jean"
date: "February 10, 2026"
format: 
  pdf: default # for final output
---

```{r}
#| eval: true
#| message: false

library(tidyverse)
```

# Questions

## Part 1

```{r}
?midwest
```

\newpage

### Question 1

```{r}
midwest |>
count(state, sort = TRUE)
```

Comment: Illinois has the most amount of counties with 102, and Wisconsin has the least with 72.

\newpage

### Question 2

```{r}

midwest |>
  count(county,state) |>
  count(county, name = "n_states")|>
  filter(n_states == n_distinct(midwest$state)) 
  
```

\newpage

### Question 3

```{r}
midwest |>
  filter(popdensity > 25000) |>
  select(county,state,popdensity,poptotal,area) |>
  arrange(desc(popdensity))
```

```{r}
midwest |>
  filter(popdensity == max(popdensity)) |>
  select(county,state,popdensity,poptotal,area)
```

\newpage

### Question 4

```{r}
midwest|>
  summarize(
    median(popdensity),
    q1 = quantile(popdensity, 0.25),
    q3 = quantile(popdensity, 0.75)
  )
```

Comment:

The distribution of population density of counties is unimodal and extremely right-skewed. A typical Midwestern county has population density of 1156.208 people per unit area. The middle 50% of the counties have population densities between 622.4074 to 2330 people per unit area.

\newpage

### Question 5

```{r}
midwest |>
  count(state,inmetro)|>
  group_by(state) |>
  mutate(prop=n/sum(n))
```

\newpage

### Question 6

```{r}
midwest |>
  filter(percbelowpoverty >=40,
         percollege <=10) |>
  select(county,state, 
         percbelowpoverty,
         percollege)
```

```{r}
midwest |>
  filter(percbelowpoverty <= 20, 
         percollege >= 40) |>
  select(county, state, 
         percbelowpoverty, 
         percollege)
```

```{r}
midwest |>
  filter(
    (percbelowpoverty >= 40 & percollege <= 10) |
  (percbelowpoverty <=20 & percollege >= 40)
) |>
  select(county, state,
         percbelowpoverty,
         percollege)
```

```{r}
midwest |> 
   mutate( 
     potential_outlier = if_else(
       (percbelowpoverty >= 40 & percollege <= 10) |
         (percbelowpoverty <=20 & percollege >= 40), 
       "Yes",
       "No"
     )
     )|>
  select(county, state, 
         percbelowpoverty, 
         percollege,
         potential_outlier)|>
  arrange(potential_outlier)
```

```{r}
midwest |> 
   mutate( 
     potential_outlier = if_else(
       (percbelowpoverty >= 40 & percollege <= 10) |
         (percbelowpoverty <=20 & percollege >= 40), 
       "Yes",
       "No"
     )
     )|>
ggplot(aes(x=percollege, y=percbelowpoverty, colour = potential_outlier, shape = state)) +
geom_point() +
  labs(x= "Population that is college educated (%)",
    y= "Population below the poverty line (%)",
    colour = "Potential Outlier",
    shape = "The state the county is in",
    title= "Percent College education vs Percent Below the Poverty Line \nby County")
```

\newpage

### Question 7

\newpage

### Question 8

\newpage

## Part 2

### Question 9
